<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ç°¡å˜é›»æ°—å›è·¯ã‚²ãƒ¼ãƒ </title>
<style>
  body { font-family:sans-serif; text-align:center; padding:20px; }
  .grid { display:grid; margin:20px auto; }
  .cell { width:60px; height:60px; border:1px solid #333; display:flex; justify-content:center; align-items:center; font-size:24px; cursor:pointer; }
  #parts { margin:20px; }
  button { font-size:16px; margin:5px; padding:5px 10px; }
</style>
</head>
<body>

<h1>ğŸ”Œ é›»æ°—å›è·¯ã‚²ãƒ¼ãƒ </h1>
<div id="question">ãƒ‘ãƒ¼ãƒ„ã‚’ç½®ã„ã¦ã€ã‚¹ã‚¤ãƒƒãƒã‹ã‚‰é›»çƒã¾ã§ã¤ãªã’ã‚ˆã†ï¼</div>

<div id="parts">
  <button onclick="selectPart('â”€')">æ¨ªç·š â”€</button>
  <button onclick="selectPart('â”‚')">ç¸¦ç·š â”‚</button>
  <button onclick="selectPart('â”Œ')">â”Œ</button>
  <button onclick="selectPart('â”')">â”</button>
  <button onclick="selectPart('â””')">â””</button>
  <button onclick="selectPart('â”˜')">â”˜</button>
  <button onclick="selectPart('â”¼')">åå­— â”¼</button>
</div>

<div id="grid" class="grid"></div>

<button onclick="checkGoal()">ãƒã‚§ãƒƒã‚¯</button>
<button onclick="resetGrid()">ãƒªã‚»ãƒƒãƒˆ</button>

<h2 id="result"></h2>

<script>
let rows = 7, cols = 5; 
let selectedPart = 'â”€';
let gridData = Array(rows).fill().map(()=>Array(cols).fill(''));
const gridEl = document.getElementById('grid');
gridEl.style.gridTemplateColumns = `repeat(${cols},60px)`;

// é›»çƒä½ç½®
let bulb1 = {r: rows-1, c: cols-1};
let bulb2 = {r: rows-1, c:0};

// åˆæœŸåŒ–
function initGrid(){
  gridEl.innerHTML = '';
  for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
      const cell = document.createElement('div');
      cell.className = 'cell';
      if(r===0 && c===0) cell.textContent = 'ğŸ”²'; // ã‚¹ã‚¤ãƒƒãƒ
      else if(r===bulb1.r && c===bulb1.c) cell.textContent = 'ğŸ’¡'; // é›»çƒ1
      else if(r===bulb2.r && c===bulb2.c) cell.textContent = 'ğŸ’¡'; // é›»çƒ2
      cell.addEventListener('click', ()=>placePart(r,c,cell));
      gridEl.appendChild(cell);
    }
  }
}
initGrid();

// ãƒ‘ãƒ¼ãƒ„é¸æŠ
function selectPart(part){ selectedPart = part; }

function placePart(r,c,cell){
  if(r===0 && c===0) return;
  if((r===bulb1.r && c===bulb1.c)||(r===bulb2.r && c===bulb2.c)) return;
  gridData[r][c] = selectedPart;
  cell.textContent = selectedPart;
}

// æ¥ç¶šåˆ¤å®šç”¨
const directions = {
  'â”€': [[0,-1],[0,1]],
  'â”‚': [[-1,0],[1,0]],
  'â”Œ': [[0,1],[1,0]],
  'â”': [[0,-1],[1,0]],
  'â””': [[0,1],[-1,0]],
  'â”˜': [[0,-1],[-1,0]],
  'â”¼': [[-1,0],[1,0],[0,-1],[0,1]]
};

// ã‚´ãƒ¼ãƒ«åˆ¤å®š
function checkGoal(){
  const visited = Array(rows).fill().map(()=>Array(cols).fill(false));
  let reached1 = false, reached2 = false;

  function dfs(r,c){
    if(r<0||r>=rows||c<0||c>=cols) return;
    if(visited[r][c]) return;

    visited[r][c]=true;

    // é›»çƒåˆ°é”
    if(r===bulb1.r && c===bulb1.c) reached1=true;
    if(r===bulb2.r && c===bulb2.c) reached2=true;

    const part = (r===0 && c===0)?'â”¼':gridData[r][c];
    if(!part) return;

    for(let [dr,dc] of directions[part]){
      let nr = r+dr, nc = c+dc;
      dfs(nr,nc);
    }
  }

  dfs(0,0);

  if(reached1 && reached2){
    document.getElementById('result').textContent = 'ğŸ‰ ã‚´ãƒ¼ãƒ«ï¼';
    randomizeBulbs();
  }else{
    document.getElementById('result').textContent = 'æ®‹å¿µï¼';
  }
}

// ãƒ©ãƒ³ãƒ€ãƒ ã§é›»çƒä½ç½®å¤‰æ›´
function randomizeBulbs(){
  const positions = [];
  for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
      if(!(r===0 && c===0)) positions.push({r,c});
    }
  }
  // ãƒ©ãƒ³ãƒ€ãƒ ã«2ã¤é¸æŠ
  const idx1 = Math.floor(Math.random()*positions.length);
  let idx2;
  do{
    idx2 = Math.floor(Math.random()*positions.length);
  }while(idx2===idx1);

  bulb1 = positions[idx1];
  bulb2 = positions[idx2];
  initGrid();
}

// ãƒªã‚»ãƒƒãƒˆ
function resetGrid(){
  gridData = Array(rows).fill().map(()=>Array(cols).fill(''));
  bulb1 = {r: rows-1, c: cols-1};
  bulb2 = {r: rows-1, c:0};
  initGrid();
  document.getElementById('result').textContent='';
}
</script>

</body>
</html>